_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[13],{jb2r:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2014-05-02-another-hello-world-to-meteorjs",function(){return n("pZjW")}])},pZjW:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return i})),n.d(t,"default",(function(){return b}));var a=n("rePB"),o=n("Ff2n"),r=(n("q1tI"),n("7ljp")),s=n("hOk3");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i={title:"Another \u2018Hello World\u2019 to MeteorJS",description:"In this tutorial, I\u2019ll try to walk you through building a simple  realtime wall (like a guestbook) where anyone can post messages. And  let\u2019s try to do this without using any magic.",intro:Object(r.a)("section",null,Object(r.a)("p",null,"In this tutorial, I\u2019ll try to walk you through building a simple  realtime wall (like a guestbook) where anyone can post messages. And  let\u2019s try to do this without using any magic.")),date:"2014-05-02",tags:["meteor"]},p={meta:i},u=Object(s.a)({meta:i});function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.a)(u,c(c(c({},p),n),{},{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"In this tutorial, I\u2019ll try to walk you through building a simple  realtime wall (like a guestbook) where anyone can post messages. And  let\u2019s try to do this without using any magic."),Object(r.a)("h3",null,"Install Meteor and Atmosphere"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Installing Meteor"),Object(r.a)("li",{parentName:"ul"},"Installing Atmosphere")),Object(r.a)("h3",null,"Create new project"),Object(r.a)("p",null,"Just go to the directory you want to create the app and create a new meteor project using following command."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"meteor create the-wall\n\n")),Object(r.a)("p",null,"Feel free to run the meteor app although we haven\u2019t even started  coding it yet. It\u2019s okay to keep it running even while you\u2019re coding."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"cd the-wall\nmeteor\n\n")),Object(r.a)("h3",null,"Remove the magic"),Object(r.a)("p",null,"We\u2019re not going to use any magical features of Meteor. So, let\u2019s remove them."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"meteor remove insecure\nmeteor remove autopublish\n\n")),Object(r.a)("h3",null,"Create a collection"),Object(r.a)("p",null,"In meteor, we\u2019ll be keeping most of our realtime data in collections. Create a new file ",Object(r.a)("inlineCode",{parentName:"p"},"posts/collections/posts.js"),".  This will make this collection available in both the server and the  client. And we want to let anyone post messages and make sure no one can  delete them."),Object(r.a)("p",null,"posts/collections/posts.js"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Posts = new Meteor.Collection('posts');\n\nPosts.allow({\n  insert: function () { return true },\n  remove: function () { return false }\n});\n\n")),Object(r.a)("h3",null,"Publish the collection"),Object(r.a)("p",null,"Data collections must be first published before they can be accessed  by clients. For our example, let\u2019s publish posts which posted in last 24  hours."),Object(r.a)("p",null,"posts/server/publications/latestPosts.js"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Meteor.publish('latestPosts', function () {\n  var yesterday = new Date().getTime() - 1000*60*60*24;\n  return Posts.find({created: {$gt: yesterday}});\n});\n\n")),Object(r.a)("p",null,"Publishing happens server side therefor we can place the code inside a directory called ",Object(r.a)("inlineCode",{parentName:"p"},"server"),". For more information about meteor directories, please read ",Object(r.a)("a",c({parentName:"p"},{href:"#"}),"Organizing Meteor files"),"."),Object(r.a)("p",null,"Let\u2019s add some example posts so we can check if everything works. Go to ",Object(r.a)("inlineCode",{parentName:"p"},"localhost:3000")," using a browser (I guess its either Firefox or Chrome). Bring up the developer console and enter the following."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'var twoDaysAgo = new Date().getTime() - 1000*60*60*24*2;\nPosts.insert({text: "Two Days Ago", created: twoDaysAgo});\n\nvar twoHoursAgo = new Date().getTime() - 1000*60*60*2;\nPosts.insert({text: "Two Hours Ago", created: twoHoursAgo});\n\nvar now = new Date().getTime();\nPosts.insert({text: "Now", created: now});\n\n')),Object(r.a)("h3",null,"Subscribe and fetch posts"),Object(r.a)("p",null,"If you try fetching them from the database, it won\u2019t work because  first we must subscribe to a publication. If you try to fetch anyways,  it\u2019ll return an empty array."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Posts.find().fetch()\n=> []\n\n")),Object(r.a)("p",null,"First you must subscribe to the publication and wait until it\u2019s ready."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"var sub = Meteor.subscribe('latestPosts');\n\n")),Object(r.a)("p",null,"After some time, the subscription will be ready. You can check it  using the ready method of the object returned by Meteor.subscribe()."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"sub.ready()\n=> true\n\n")),Object(r.a)("p",null,"Finally, you can access posts from the client."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'Posts.find().fetch().toString()\n=> "[object Object],[object Object]"\n\n')),Object(r.a)("p",null,"You\u2019ll notice that although there are 3 docs in the collection, only 2  gets to the client through this publication/subscription. This happens  because we have limited docs sent to the client when publishing them."),Object(r.a)("h3",null,"Method to add posts"),Object(r.a)("p",null,"Earlier we added posts from the client side and we set the created  time manually. To make things simpler, we can create a Meteor method  which does this for us."),Object(r.a)("p",null,"posts/server/methods/saveMethod.js"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Meteor.methods({\n  addPost: function (text) {\n    check(text, String);\n    Posts.insert({\n      text: text,\n      created: new Date().getTime()\n    });\n  }\n});\n\n")),Object(r.a)("p",null,"And we can make sure this works by calling the method form the client. Try running this command on browser console."),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Meteor.call('addPost', 'Added using method');\n\n")),Object(r.a)("h2",null,"Finally the UI"),Object(r.a)("p",null,"Let\u2019s just wrap things up with a simple UI."),Object(r.a)("h3",null,"Main Wrapper"),Object(r.a)("p",null,"client/index.html"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'<body>\n  <div id="wrapper">\n    {{> newPost}}\n    {{> postsList}}\n  </div>\n</body>\n\n')),Object(r.a)("p",null,"client/index.css"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"#wrapper {\n  max-width: 900px;\n  margin: 5em auto;\n  padding: 0 5em;\n  font-family: sans-serif;\n}\n\n")),Object(r.a)("h3",null,"Form to add new post"),Object(r.a)("p",null,"posts/client/newPost.html"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'<template name="newPost">\n  <div id="newPost">\n    <textarea autofocus id="newPostText"></textarea>\n    <button id="newPostButton">Save Post</button>\n  </div>\n</template>\n\n')),Object(r.a)("p",null,"posts/client/newPost.css"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"#newPost textarea {\n  display: block;\n  width: 100%;\n  height: 2.5em;\n  padding: 0.5em 0.75em;\n  outline: none;\n  font-size: 1.5em;\n  box-sizing: border-box;\n}\n\n#newPost button {\n  display: block;\n  width: 100%;\n  background: rgba(0,0,0,0.05);\n  border: 1px solid rgba(0,0,0,0.1);\n  outline: none;\n}\n\n")),Object(r.a)("p",null,"posts/client/newPost.js"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Template.newPost.events({\n  'click #newPostButton': function (e) {\n    var textarea = $('#newPostText');\n    var text = textarea.val();\n    Meteor.call('addPost', text);\n    textarea.val('');\n  }\n});\n\n")),Object(r.a)("h3",null,"List Posts"),Object(r.a)("p",null,"posts/client/postsList.html"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),'<template name="postsList">\n  <ul id="postsList">\n  {{#each posts}}\n    <li>{{text}}</li>\n  {{/each}}\n  </ul>\n</template>\n\n')),Object(r.a)("p",null,"posts/client/postsList.css"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"#postsList {\n  padding: 0;\n}\n\n#postsList li {\n  display: block;\n  font-size: 1em;\n  background: rgba(0,0,0,0.05);\n  padding: 1.5em 2em;\n  margin: 1em 0;\n  border: 1px solid rgba(0,0,0,0.1);\n}\n\n")),Object(r.a)("p",null,"posts/client/postsList.js"),Object(r.a)("pre",null,Object(r.a)("code",c({parentName:"pre"},{}),"Meteor.subscribe('latestPosts');\n\nTemplate.postsList.posts = function () {\n  return Posts.find();\n}\n\n")),Object(r.a)("p",null,"Original Post: ",Object(r.a)("a",c({parentName:"p"},{href:"https://mnmtanish.svbtle.com/another-hello-world-to-meteorjs"}),"https://mnmtanish.svbtle.com/another-hello-world-to-meteorjs")))}b.isMDXComponent=!0}},[["jb2r",0,1,2]]]);