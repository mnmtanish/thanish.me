_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{Hzzr:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/2014-09-08-isolated-testing",function(){return n("vrAy")}])},vrAy:function(e,t,n){"use strict";n.r(t),n.d(t,"meta",(function(){return l})),n.d(t,"default",(function(){return h}));var a=n("rePB"),s=n("Ff2n"),o=(n("q1tI"),n("7ljp")),r=n("hOk3");function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={title:"Isolated Testing",description:"Just thought of sharing something about writing tests with  JavaScript. Usually, it's best to keep tests simple and test just one  thing per test (the _thing_ is most of the time just a _function_).",intro:Object(o.a)("section",null,Object(o.a)("p",null,"Just thought of sharing something about writing tests with  JavaScript. Usually, it's best to keep tests simple and test just one  thing per test (the _thing_ is most of the time just a _function_).")),date:"2014-09-08",tags:["js"]},p={meta:l},u=Object(r.a)({meta:l});function h(e){var t=e.components,n=Object(s.a)(e,["components"]);return Object(o.a)(u,c(c(c({},p),n),{},{components:t,mdxType:"MDXLayout"}),Object(o.a)("p",null,"Just thought of sharing something about writing tests with  JavaScript. Usually, it's best to keep tests simple and test just one  thing per test (the ",Object(o.a)("em",{parentName:"p"},"thing")," is most of the time just a ",Object(o.a)("em",{parentName:"p"},"function"),")."),Object(o.a)("p",null,"If we use functions we're about to test the way we use them in real  programs, tests can get very lengthy and complicated easily. Usually  we'll have to write more boilerplate code than real test code. And even  worse, tests may fail for the ",Object(o.a)("em",{parentName:"p"},"wrong reason"),". As a really simple example, assume we want to test the constructor here."),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-js"}),"function Person (name) {\n  this._validateName(name);\n  this.name = name;\n}\n\nPerson.prototype._validateName = function (name) {\n  assert.equal(typeof name, 'string');\n}\n")),Object(o.a)("p",null,"This is how I used to write tests."),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-js"}),"describe('constructor', function() {\n  it('should validate the name', function() {\n    var original = Person.prototype._validateName;\n    Person.prototype._validateName = function (name) {\n        this.name__ = name;\n    };\n    var person = new Person('name');\n    assert.equal(person.name__, 'name');\n    Person.prototype._validateName = original;\n  });\n\n  it('should save the name', function() {\n    var person = new Person('name');\n    assert.equal(person.name, 'name');\n  });\n});\n")),Object(o.a)("p",null,"When testing certain parts, I had to temporarily change the prototype  and restore it after the test. And I also had to consider the rest of  the program too. In this example, I must make sure the ",Object(o.a)("inlineCode",{parentName:"p"},"name")," is a string, otherwise it'll throw an error and tests will fail. What  we must remember is that the constructor is only responsible for calling  the validation function and not how the validation works. This can get  extremely complex when dealing with large data structures."),Object(o.a)("p",null,"Thanks to JavaScript ",Object(o.a)("inlineCode",{parentName:"p"},"function.call"),", we can isolate the function we're about to test from the rest of the class/prototype. We can write tests like this."),Object(o.a)("pre",null,Object(o.a)("code",c({parentName:"pre"},{className:"language-js"}),"describe('constructor', function() {\n  it('should validate the name', function() {\n    var person = {\n        _validateName: function (name) {\n            this.name__ = name;\n        }\n    };\n    Person.call(person, 1);\n    assert.equal(person.name__, 1);\n  });\n\n  it('should save the name', function() {\n    var person = {_validateName: Function.prototype};\n    Person.call(person, 1);\n    assert.equal(person.name, 1);\n  });\n});\n")),Object(o.a)("p",null,"As an added advantage, we can clearly see what other parts the  function interacts with and how it interacts with other parts of the  program."))}h.isMDXComponent=!0}},[["Hzzr",0,1,2]]]);